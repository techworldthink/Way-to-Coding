To create a REST API in Go using Swagger (with `swagger: "2.0"`) and the **Go Swagger** toolkit, follow these steps:

### 1. Install Go and Swagger

Ensure that Go and the Go Swagger toolkit are installed on your Windows machine.

1. **Install Go**:
   - Download Go from [https://golang.org/dl/](https://golang.org/dl/).
   - Install it and verify the installation:
     ```bash
     go version
     ```

2. **Install Go Swagger**:
   - Install the Go Swagger toolkit using `go get`:
     ```bash
     go install github.com/go-swagger/go-swagger/cmd/swagger@latest
     ```
   - Ensure that the Go `bin` directory is added to your system's PATH.

     Example:
     ```bash
     setx PATH "%PATH%;%USERPROFILE%\go\bin"
     ```

   - Verify the installation:
     ```bash
     swagger version
     ```

---

### 2. Create Swagger Specification

Create a **swagger.yaml** file to define your API. Here's a sample `swagger.yaml` file for a simple "ToDo" API:

```yaml
swagger: "2.0"
info:
  description: "This is a sample ToDo API."
  version: "1.0.0"
  title: "ToDo API"
  
paths:
  /todos:
    get:
      summary: "Get all ToDos"
      responses:
        200:
          description: "A list of ToDos."
          schema:
            type: "array"
            items:
              $ref: "#/definitions/ToDo"
    post:
      summary: "Create a new ToDo"
      parameters:
        - in: "body"
          name: "body"
          description: "The ToDo to create"
          required: true
          schema:
            $ref: "#/definitions/ToDo"
      responses:
        201:
          description: "ToDo created"
          schema:
            $ref: "#/definitions/ToDo"

definitions:
  ToDo:
    type: "object"
    required:
      - id
      - task
    properties:
      id:
        type: "integer"
        format: "int64"
      task:
        type: "string"
      completed:
        type: "boolean"
```

---

### 3. Generate Server Code

After creating the `swagger.yaml` file, use Go Swagger to generate the server code.

1. **Flatten the Swagger file** (if it has external references):
   ```bash
   swagger flatten swagger.yaml -o flattened-swagger.yaml
   ```

2. **Validate the Swagger file**:
   ```bash
   swagger validate swagger.yaml
   ```

   This checks for any errors or inconsistencies in the Swagger specification.

3. **Create a Go Module**
    ```bash
    go mod init todo-api
    ```

4. **Generate the Server Code**:
   Create a folder `todo-api`
   
   Run the following command to generate Go server code:
   ```bash
   swagger generate server -t ./todo-api -f swagger.yaml
   ```

   - `-t ./todo-api`: Specifies the target output directory for the generated server.
   - `-f swagger.yaml`: Specifies the input Swagger specification file.

---

### 4. Review the Generated Files

Example Directory Structure
```
C:\Users\jobin\Project\Go
│
├── swagger.yaml
├── go.mod
└── todo-api
    ├── cmd
    │   └── todo-api-server
    │       └── main.go
    ├── models
    └── restapi
```

Go Swagger generates several directories and files:
- **models/**: Contains Go structs based on the data models from the Swagger specification (e.g., `ToDo`).
- **restapi/**: Contains the API server logic, handlers, and configuration.
- **cmd/**: Contains the `main.go` file for starting the server.

The important directories are:
- **restapi/operations/**: Contains the operation handlers (e.g., `get_todos.go`, `post_todos.go`).
- **models/**: Defines the `ToDo` model based on the Swagger definitions.

---

### 5. Implement Business Logic

Go Swagger generates basic handler functions, but they are just stubs. You need to implement the business logic in the generated handlers.


You should create the custom_handlers.go file in the same package as your other operation files, typically in the operations directory. This way, it stays organized with the other handler files generated by Swagger.

```go
// custom_handlers.go
package operations

import (
    "github.com/go-openapi/runtime/middleware"
    "todo-api/todo-api/models"
)

// List of in-memory ToDos
var todos = []*models.ToDo{
    {ID: int64Ptr(1), Task: stringPtr("Buy milk"), Completed: false},
    {ID: int64Ptr(2), Task: stringPtr("Read book"), Completed: true},
}

// Helper function to create *int64
func int64Ptr(i int64) *int64 {
    return &i
}

// Helper function to create *string
func stringPtr(s string) *string {
    return &s
}

// CustomGetTodosHandler is your implementation for the GetTodos API
func CustomGetTodosHandler(params GetTodosParams) middleware.Responder {
    return NewGetTodosOK().WithPayload(todos)
}
```

You would do a similar implementation for the other operations such as `post_todos.go`.

---

### 6. Install Required Packages
```bash
go get ./...
```

### 7. Build and Run the API Server

1. Navigate to the generated `cmd/<your-app-name>` directory:
   ```bash
   cd todo-api/cmd/todo-api-server
   ```

2. Run the server:
   ```bash
   go run main.go
   ```

The server should start, and you can access your API at `http://localhost:8080`.

---

### 8. Access the API

Test your API by sending HTTP requests. You can use `curl` or a tool like Postman to interact with the API:

1. **GET All ToDos**:
   ```bash
   curl http://localhost:8080/todos
   ```

2. **POST a new ToDo**:
   ```bash
   curl -X POST -H "Content-Type: application/json" \
   -d '{"id":3, "task":"Walk the dog", "completed":false}' \
   http://localhost:8080/todos
   ```

---

